<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

  <head>
    <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Errors </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Errors ">
    
      <link rel="shortcut icon" href="../favicon.ico">
      <link rel="stylesheet" href="../styles/docfx.vendor.css">
      <link rel="stylesheet" href="../styles/docfx.css">
      <link rel="stylesheet" href="../styles/main.css">
      <meta property="docfx:navrel" content="../toc.html">
      <meta property="docfx:tocrel" content="toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
<h1 id="errors">Errors</h1>

<p>Errors returned will contain only the properties that are set on the <code>ErrorObject</code> class. Custom fields can be added through <code>ErrorObject.Meta</code>.
You can create a custom error by throwing a <code>JsonApiException</code> (which accepts an <code>ErrorObject</code> instance), or returning an <code>ErrorObject</code> instance from an <code>ActionResult</code> in a controller.
Please keep in mind that JSON:API requires <code>Title</code> to be a generic message, while <code>Detail</code> should contain information about the specific problem occurence.</p>
<p>From a controller method:</p>
<pre><code class="lang-c#">return Conflict(new ErrorObject(HttpStatusCode.Conflict)
{
    Title = &quot;Target resource was modified by another user.&quot;,
    Detail = $&quot;User {userName} changed the {resourceField} field on {resourceName} resource.&quot;
});
</code></pre>
<p>From other code:</p>
<pre><code class="lang-c#">throw new JsonApiException(new ErrorObject(HttpStatusCode.Conflict)
{
    Title = &quot;Target resource was modified by another user.&quot;,
    Detail = $&quot;User {userName} changed the {resourceField} field on {resourceName} resource.&quot;
});
</code></pre>
<p>In both cases, the middleware will properly serialize it and return it as a JSON:API error.</p>
<h1 id="exception-handling">Exception handling</h1>
<p>The translation of user-defined exceptions to error responses can be customized by registering your own handler.
This handler is also the place to choose the log level and message, based on the exception type.</p>
<pre><code class="lang-c#">public class ProductOutOfStockException : Exception
{
    public int ProductId { get; }

    public ProductOutOfStockException(int productId)
    {
        ProductId = productId;
    }
}

public class CustomExceptionHandler : ExceptionHandler
{
    public CustomExceptionHandler(ILoggerFactory loggerFactory, IJsonApiOptions options)
        : base(loggerFactory, options)
    {
    }

    protected override LogLevel GetLogLevel(Exception exception)
    {
        if (exception is ProductOutOfStockException)
        {
            return LogLevel.Information;
        }

        return base.GetLogLevel(exception);
    }

    protected override string GetLogMessage(Exception exception)
    {
        if (exception is ProductOutOfStockException productOutOfStock)
        {
            return $&quot;Product {productOutOfStock.ProductId} is currently unavailable.&quot;;
        }

        return base.GetLogMessage(exception);
    }

    protected override IReadOnlyList&lt;ErrorObject&gt; CreateErrorResponse(Exception exception)
    {
        if (exception is ProductOutOfStockException productOutOfStock)
        {
            return new[]
            {
                new ErrorObject(HttpStatusCode.Conflict)
                {
                    Title = &quot;Product is temporarily available.&quot;,
                    Detail = $&quot;Product {productOutOfStock.ProductId} &quot; +
                        &quot;cannot be ordered at the moment.&quot;
                }
            };
        }

        return base.CreateErrorResponse(exception);
    }
}

// Program.cs
builder.Services.AddScoped&lt;IExceptionHandler, CustomExceptionHandler&gt;();
</code></pre>
</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/json-api-dotnet/JsonApiDotNetCore/blob/master/docs/usage/errors.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In This Article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      
      <span>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>
  </body>
</html>
